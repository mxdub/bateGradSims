library(bateGradSims)

n_females = 100
n_males = 110
n_gamete_fem = 50
ratio_gamete = 10
cv_normal_male = 0.1

# Get gametes
gametes = gametes_drawing(n_females = n_females, n_males = n_males,
                          mean_gamete_female = n_gamete_fem, ratio_gamete = ratio_gamete,
                          male_distrib_params = cv_normal_male)

# Get males comp. values
male_comp_values = get_male_comp_values(n_males = n_males, sd_comp = 10, plot = T)

# Get pollen repartition
pollen_repartition = pollen_export(n_females = n_females,
                                    gametes_by_male = gametes$gam_male,
                                    pollen_repartition = list(mean = -2, sd = 0.2),
                                    plot = T)

# Mating Success (exact) can then be computed from the pollen_repartition, e.g.,
mso_female = apply(pollen_repartition, 1, FUN = function(x) sum(x>0) )
mso_male = apply(pollen_repartition, 2, FUN = function(x) sum(x>0) )

# Pollen competition, i.e., who fertilized who
